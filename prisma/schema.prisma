generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                 String  @id @default(cuid())
  clerkId            String
  image              String?
  imagePublicId      String?
  coverImage         String?
  coverImagePublicId String?
  bio                String?
  name               String
  email              String  @unique

  bookmark Bookmark[]

  images   Image[]
  likes    Like[]
  comments Comment[]
  socials  Social?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("user")
}

model Social {
  id Int @id @default(autoincrement())

  platforms Json //Object type

  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Image {
  id          String  @id @default(cuid())
  imageUrl    String
  title       String
  description String?

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  likes    Like[]
  comments Comment[]
  bookmark Bookmark[]
  category String?

  createdAt DateTime @default(now())
}

model Like {
  id Int @id @default(autoincrement())

  userId  String
  imageId String

  user  User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  image Image @relation(fields: [imageId], references: [id], onDelete: Cascade)

  @@unique([userId, imageId])
}

model Comment {
  id Int @id @default(autoincrement())

  comment String

  userId  String
  imageId String

  user  User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  image Image @relation(fields: [imageId], references: [id], onDelete: Cascade)
}

model Bookmark {
  id Int @id @default(autoincrement())

  imageId String
  userId  String

  image Image @relation(fields: [imageId], references: [id], onDelete: Cascade)
  user  User  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, imageId])
}
